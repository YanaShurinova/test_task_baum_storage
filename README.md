# Описание реализации

## Стэк технологий
  - БД - PostgreSQL;
  - Брокер сообщений - Apache Kafka;
  - Миграции - alembic;
  - Работа с БД - sqlalchemy
  - Менеджер зависимостей - poetry.

## Описание эндпоинтов
  - /texts (PUT эндпоинт):
    - на вход подается файл .txt (UploadFile);
    - запоминается дата запроса;
    - идет построчное чтение файла, проверка на строку, содержащую пробелы (чтобы в БД не клались пустые строки);
    - отправляется объект типа SendDownloadRequest(дата, сохраненная ранее; название файла, строка) в брокер сообщений;
    - ожидание 3с (чтобы выполнялась требование из задания - оправка сообщений в брокер с интервалом 3с);
    - консьюмер берет сообщений, переводит его в формат json и сохраняется в БД в формате: дата, название файла, длина строки, число вхождений 'х' в строку. Оформление и подключение к БД выделено в директорию src.app.db.

  - /texts/avg (GET эндпоинт):
    - осуществлен с использованием sql запроса:
      - название файла, общее число символов, общее число вхождений буквы х;
    - проходя по каждой из записи подсчитывается среднее значение = общее число вхождений х, деленное на общее число символов в файле;
    - возвращается список из объектов типа GetResponse(дата, название, среднее значение вхождения х).